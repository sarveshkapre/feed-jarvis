<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Feed Jarvis Studio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:wght@500;700&family=Sora:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <header class="site-header">
      <div class="brand">
        <div class="brand-title">Feed Jarvis Studio</div>
        <div class="brand-subtitle">A calm workspace for turning feeds into ready-to-post drafts.</div>
      </div>
      <nav class="nav">
        <a class="active" href="/">Studio</a>
        <a href="/about">About</a>
        <a
          href="https://github.com/sarveshkapre/feed-jarvis"
          target="_blank"
          rel="noreferrer noopener"
          >GitHub</a
        >
      </nav>
    </header>

    <main>
      <section class="hero">
        <h1>Turn fresh updates into on-brand social drafts in minutes.</h1>
        <p>
          Feed Jarvis Studio pairs your RSS or JSON feeds with personas that keep your voice consistent.
          Review, edit, and export posts in one focused flow.
        </p>
        <div class="badges">
          <span class="badge">Local-first</span>
          <span class="badge">RSS + JSON</span>
          <span class="badge">Persona presets</span>
          <span class="badge">Multi-channel</span>
          <span class="badge">Draft-ready output</span>
        </div>
      </section>

      <section class="grid">
        <article class="card" id="step-items">
          <div class="card-header">
            <div>
              <div class="step-chip">Step 1 · Bring items in</div>
              <h2>Choose a source</h2>
              <p>Start with one or more feed URLs, or paste your event list.</p>
            </div>
            <div class="toggle" role="tablist">
              <button type="button" class="active" data-source="feed">Feed URL(s)</button>
              <button type="button" data-source="json">Paste JSON</button>
            </div>
          </div>
          <div class="controls" data-panel="feed">
            <label for="feedUrls">
              Feed URLs
              <span>One per line. We auto-allow each host for safety.</span>
            </label>
            <textarea
              id="feedUrls"
              placeholder="https://example.com/rss.xml\nhttps://news.example.com/atom.xml"
            ></textarea>
            <div class="feed-presets">
              <div class="inline-row">
                <label for="feedSetSelect">
                  Feed set
                  <span>Save, import, and export groups of feed URLs (local-only).</span>
                </label>
                <select id="feedSetSelect">
                  <option value="">Choose a saved set…</option>
                </select>
              </div>
              <div class="button-row">
                <input id="feedSetsFile" type="file" accept=".opml,.xml,text/xml,application/xml" hidden />
                <button class="ghost" id="loadFeedSetBtn" type="button" disabled>Load</button>
                <button class="ghost" id="saveFeedSetBtn" type="button">Save</button>
                <button class="ghost" id="importFeedSetsBtn" type="button">Import OPML</button>
                <button class="ghost" id="exportFeedSetsBtn" type="button">Export OPML</button>
                <button class="secondary" id="deleteFeedSetBtn" type="button" disabled>Delete</button>
              </div>
              <div class="status" id="feedSetStatus" role="status" aria-live="polite"></div>
            </div>
            <div class="inline-row">
              <label for="maxItems">Max items</label>
              <input id="maxItems" type="number" min="1" value="20" />
              <label for="fetchConcurrency">Fetch concurrency</label>
              <input
                id="fetchConcurrency"
                type="number"
                min="1"
                max="20"
                value="4"
              />
              <label class="switch">
                <input id="dedupe" type="checkbox" checked />
                Dedupe by URL
              </label>
            </div>
            <div class="button-row">
              <button class="primary" id="fetchBtn">Fetch items</button>
              <span class="kbd">Ctrl / Cmd + Enter</span>
            </div>
            <div class="status" id="itemsStatus" role="status" aria-live="polite"></div>
          </div>
          <div class="controls" data-panel="json" hidden>
            <label for="jsonItems">
              Items JSON
              <span>Paste a JSON array of {"title", "url"} objects. URLs must use http/https.</span>
            </label>
            <textarea
              id="jsonItems"
              placeholder='[{"title":"Hello world","url":"https://example.com"}]'
            ></textarea>
            <div class="button-row">
              <button class="primary" id="loadJsonBtn">Load items</button>
            </div>
            <div class="status" id="jsonStatus" role="status" aria-live="polite"></div>
          </div>
          <div class="filters">
            <h3>Filter items (optional)</h3>
            <div class="filter-presets">
              <div class="inline-row">
                <label for="filterPresetSelect">
                  Filter preset
                  <span>Save and recall include/exclude/min-title filters (local-only).</span>
                </label>
                <select id="filterPresetSelect">
                  <option value="">Choose a saved preset…</option>
                </select>
              </div>
              <div class="button-row">
                <input
                  id="filterPresetsFile"
                  type="file"
                  accept="application/json,.json"
                  hidden
                />
                <button class="ghost" id="loadFilterPresetBtn" type="button" disabled>Load</button>
                <button class="ghost" id="saveFilterPresetBtn" type="button">Save</button>
                <button class="ghost" id="importFilterPresetsBtn" type="button">Import JSON</button>
                <button class="ghost" id="exportFilterPresetsBtn" type="button">Export JSON</button>
                <button class="secondary" id="deleteFilterPresetBtn" type="button" disabled>Delete</button>
              </div>
              <div class="status" id="filterPresetStatus" role="status" aria-live="polite"></div>
            </div>
            <div class="filter-grid">
              <label for="filterInclude">Include keywords</label>
              <input
                id="filterInclude"
                type="text"
                placeholder="release, launch, pricing"
                autocomplete="off"
              />
              <label for="filterExclude">Exclude keywords</label>
              <input
                id="filterExclude"
                type="text"
                placeholder="hiring, podcast, recap"
                autocomplete="off"
              />
              <label for="filterMinTitleLength">Min title length</label>
              <input id="filterMinTitleLength" type="number" min="0" value="0" />
            </div>
            <div class="token-row" id="filterTokens" hidden></div>
            <p class="filter-help">
              Matches are case-insensitive. Include matches any keyword. Exclude wins. Use
              <code>site:example.com</code> to mute a domain.
            </p>
            <div class="status" id="filterStatus" role="status" aria-live="polite"></div>
          </div>
          <div class="preview" aria-live="polite">
            <h3>Items preview</h3>
            <div class="empty" id="itemsEmpty">No items yet. Add a feed to see results.</div>
            <ul id="itemsList"></ul>
            <div class="button-row">
              <button class="ghost" id="downloadItemsBtn" type="button" disabled>
                Download items.json
              </button>
              <button class="secondary" id="copyItemsBtn" type="button" disabled>Copy items JSON</button>
            </div>
            <div class="status" id="itemsExportStatus" role="status" aria-live="polite"></div>
          </div>
        </article>

        <article class="card" id="step-persona">
          <div class="card-header">
            <div>
              <div class="step-chip">Step 2 · Set the voice</div>
              <h2>Select a persona</h2>
              <p>Choose a preset, then tune it with your own prefix if needed.</p>
            </div>
          </div>
          <div class="controls">
            <label for="personaSelect">
              Persona
              <span>Presets ship with a short prefix that sets the tone.</span>
            </label>
            <select id="personaSelect"></select>
            <div class="button-row">
              <input id="personasFile" type="file" accept="application/json,.json" hidden />
              <button class="ghost" id="importPersonasBtn" type="button">Import personas</button>
              <button class="ghost" id="exportPersonasBtn" type="button">Export personas</button>
              <button class="secondary" id="clearPersonasBtn" type="button">Clear imports</button>
            </div>
            <div class="status" id="personasStatus" role="status" aria-live="polite"></div>
            <label class="switch">
              <input id="customPersonaToggle" type="checkbox" />
              Use a custom persona
            </label>
            <div class="inline-row" id="customPersonaFields" hidden>
              <label for="customPersonaName">Custom name</label>
              <input id="customPersonaName" type="text" placeholder="Creator" />
              <label for="customPersonaPrefix">Custom prefix</label>
              <input id="customPersonaPrefix" type="text" placeholder="Creator:" />
            </div>
            <label for="personaSearch">
              Find persona cards
              <span>Search by name, prefix, role, style, voice, or topics.</span>
            </label>
            <input
              id="personaSearch"
              type="text"
              placeholder="Try: macro, ai, policy, builder"
              autocomplete="off"
            />
            <div class="status" id="personaSearchStatus" role="status" aria-live="polite"></div>
            <div class="persona-grid" id="personaCards"></div>
          </div>
        </article>

        <article class="card" id="step-generate">
          <div class="card-header">
            <div>
              <div class="step-chip">Step 3 · Review drafts</div>
              <h2>Generate and edit posts</h2>
              <p>Drafts are ready to export. Edit inline and keep an eye on length.</p>
            </div>
          </div>
          <div class="controls">
            <label>
              Channel
              <span>Choose the destination. We set a sensible max length.</span>
            </label>
            <div class="toggle" id="channelToggle">
              <button type="button" class="active" data-channel="x">X</button>
              <button type="button" data-channel="linkedin">LinkedIn</button>
              <button type="button" data-channel="newsletter">Newsletter</button>
            </div>
            <label for="templateSelect">
              Style
              <span>Pick a framing cue for the draft.</span>
            </label>
            <select id="templateSelect">
              <option value="straight">Straight</option>
              <option value="takeaway">Takeaway</option>
              <option value="cta">Call to action</option>
            </select>
            <label for="generationModeSelect">
              Engine
              <span>Template runs locally. GPT mode uses the server OpenAI key.</span>
            </label>
            <select id="generationModeSelect">
              <option value="template">Template (local)</option>
              <option value="llm">GPT (OpenAI)</option>
            </select>
            <label for="llmModelInput">
              GPT model
              <span>Used only when Engine is GPT.</span>
            </label>
            <input id="llmModelInput" type="text" value="gpt-4.1-mini" autocomplete="off" />
            <div class="inline-row">
              <label for="maxChars">Max characters</label>
              <input id="maxChars" type="number" min="1" value="280" />
            </div>
            <div class="rules">
              <h3>Text rules (optional)</h3>
              <div class="rule-presets">
                <div class="inline-row">
                  <label for="rulePresetSelect">
                    Rule preset
                    <span>Save and recall text-rule combinations (local-only).</span>
                  </label>
                  <select id="rulePresetSelect">
                    <option value="">Choose a saved preset…</option>
                  </select>
                </div>
                <div class="button-row">
                  <button class="ghost" id="loadRulePresetBtn" type="button" disabled>Load</button>
                  <button class="ghost" id="saveRulePresetBtn" type="button">Save</button>
                  <button class="secondary" id="deleteRulePresetBtn" type="button" disabled>Delete</button>
                </div>
                <div class="status" id="rulePresetStatus" role="status" aria-live="polite"></div>
              </div>
              <div class="rules-grid">
                <label for="rulePrepend">Prepend text</label>
                <input
                  id="rulePrepend"
                  type="text"
                  placeholder="New:"
                  autocomplete="off"
                />
                <label for="ruleAppend">Append text</label>
                <input
                  id="ruleAppend"
                  type="text"
                  placeholder="Worth a look."
                  autocomplete="off"
                />
                <label for="ruleHashtags">Hashtags</label>
                <input
                  id="ruleHashtags"
                  type="text"
                  placeholder="#Product, ai, #Launch"
                  autocomplete="off"
                />
              </div>
              <label class="switch">
                <input id="utmToggle" type="checkbox" />
                Add UTM tags to links
              </label>
              <div class="rules-grid" id="utmFields" hidden>
                <label for="utmSource">utm_source</label>
                <input id="utmSource" type="text" placeholder="feed-jarvis" autocomplete="off" />
                <label for="utmMedium">utm_medium</label>
                <input id="utmMedium" type="text" placeholder="social" autocomplete="off" />
                <label for="utmCampaign">utm_campaign</label>
                <input id="utmCampaign" type="text" placeholder="launch" autocomplete="off" />
              </div>
              <p class="rule-help">
                Rules apply before the link. Drafts are always truncated to honor max characters.
              </p>
            </div>
            <div class="button-row">
              <button class="primary" id="generateBtn">Generate posts</button>
              <button class="secondary" id="copyAllBtn" disabled>Copy all</button>
              <button class="ghost" id="downloadTxtBtn" disabled>Download drafts .txt</button>
              <button class="ghost" id="downloadJsonBtn" disabled>Download drafts .jsonl</button>
              <button class="ghost" id="downloadCsvBtn" disabled>Download drafts .csv</button>
            </div>
            <p class="shortcut-help">
              Shortcuts:
              <span class="kbd">Ctrl/Cmd + Shift + Enter</span> generate,
              <span class="kbd">Ctrl/Cmd + Shift + C</span> copy all,
              <span class="kbd">Ctrl/Cmd + Shift + E</span> download .jsonl
            </p>
            <div class="status" id="postsStatus" role="status" aria-live="polite"></div>
          </div>
          <div class="preview">
            <h3>Drafts</h3>
            <div class="empty" id="postsEmpty">Generate drafts to see them here.</div>
            <div class="posts" id="postsList"></div>
          </div>
        </article>

        <article class="card" id="step-agent-feed">
          <div class="card-header">
            <div>
              <div class="step-chip">Step 4 · Agent timeline</div>
              <h2>Build a multi-persona feed</h2>
              <p>Generate a Twitter-like stream from many personas over your current item set.</p>
            </div>
          </div>
          <div class="controls">
            <div class="inline-row">
              <label for="agentPersonaLimit">Persona count</label>
              <input id="agentPersonaLimit" type="number" min="1" max="100" value="12" />
            </div>
            <label for="agentPersonaNames">
              Persona names (optional)
              <span>Comma-separated exact names to pin specific agents. Leave empty for top N.</span>
            </label>
            <textarea
              id="agentPersonaNames"
              placeholder="Macro Hawk, AI Researcher, News Wire"
            ></textarea>
            <label for="agentPersonaMaxChars">
              Per-persona max chars (optional)
              <span>Format: one per line, e.g. <code>Macro Hawk:220</code>.</span>
            </label>
            <textarea
              id="agentPersonaMaxChars"
              placeholder="Macro Hawk:220&#10;AI Builder:180"
            ></textarea>
            <label for="agentPersonaSearch">
              Filter rendered feed (optional)
              <span>Search by persona name after you build the feed.</span>
            </label>
            <input
              id="agentPersonaSearch"
              type="text"
              placeholder="Try: macro, ai, wire"
              autocomplete="off"
            />
            <div class="status" id="agentPersonaSearchStatus" role="status" aria-live="polite"></div>
            <label for="agentLayoutSelect">
              Feed layout
              <span>Rotating covers more events. Consensus compares many personas on one event.</span>
            </label>
            <select id="agentLayoutSelect">
              <option value="rotating">Rotating events</option>
              <option value="consensus">Consensus on top event</option>
            </select>
            <div class="button-row">
              <button class="primary" id="buildAgentFeedBtn" type="button">Build agent feed</button>
              <button class="secondary" id="copyAgentFeedBtn" type="button" disabled>Copy feed</button>
              <button class="ghost" id="downloadAgentFeedBtn" type="button" disabled>
                Download feed .json
              </button>
            </div>
            <p class="shortcut-help">
              Shortcuts:
              <span class="kbd">Ctrl/Cmd + Shift + B</span> build,
              <span class="kbd">Ctrl/Cmd + Shift + K</span> copy,
              <span class="kbd">Ctrl/Cmd + Shift + J</span> download .json
            </p>
            <div class="status" id="agentFeedStatus" role="status" aria-live="polite"></div>
          </div>
          <div class="preview">
            <h3>Agent feed</h3>
            <div class="empty" id="agentFeedEmpty">Build the agent feed to see the timeline.</div>
            <div class="posts" id="agentFeedList"></div>
          </div>
        </article>
      </section>

      <section class="footer">
        <div>Built for social teams who value speed and consistency.</div>
        <div>
          Shortcuts:
          <span class="kbd">Ctrl/Cmd + Enter</span> fetch/load,
          <span class="kbd">Ctrl/Cmd + Shift + Enter</span> generate,
          <span class="kbd">Ctrl/Cmd + Shift + B</span> build feed
        </div>
      </section>
    </main>

    <script type="module" src="/app.js"></script>
  </body>
</html>
