# Clone Feature Tracker

## Context Sources
- README and docs
- TODO/FIXME markers in code
- Test and build failures
- Gaps found during codebase exploration

## Candidate Features To Do
- [ ] P2: Studio saved filter presets (include/exclude/min-title) for repeatable triage workflows. (Impact 4, Effort 3, Fit 4, Diff 1, Risk 1, Conf 3)
- [ ] P2: Studio per-item "mute domain" quick action that appends to filter exclusion terms locally. (Impact 4, Effort 3, Fit 4, Diff 2, Risk 1, Conf 3)
- [ ] P2: Add Studio-side URL normalization helper for pasted feeds (strip whitespace/tracking junk safely). (Impact 3, Effort 2, Fit 4, Diff 0, Risk 2, Conf 3)
- [ ] P2: Add server-side request id in API error payloads for better troubleshooting in Studio. (Impact 3, Effort 2, Fit 4, Diff 0, Risk 1, Conf 4)
- [ ] P2: Add retries summary fields to `/api/fetch` response (`retryAttempts`, `retrySuccesses`) for UX visibility. (Impact 3, Effort 2, Fit 4, Diff 0, Risk 1, Conf 3)
- [ ] P2: Add fetch latency telemetry fields to `/api/fetch` summary (`durationMs`, `slowestFeedMs`) for large-run troubleshooting. (Impact 3, Effort 2, Fit 4, Diff 0, Risk 1, Conf 3)
- [ ] P2: Add targeted unit coverage for session persistence edge cases (invalid snapshots, stale keys, partial payloads). (Impact 3, Effort 2, Fit 4, Diff 0, Risk 1, Conf 4)
- [ ] P2: Add CLI regression tests for output piping behavior (`EPIPE`) across text/json/jsonl/csv formats. (Impact 3, Effort 2, Fit 4, Diff 0, Risk 1, Conf 4)
- [ ] P2: Add optional `--dry-run` generation mode with richer diagnostics (invalid items, duplicate URLs, truncation counts). (Impact 4, Effort 3, Fit 4, Diff 1, Risk 1, Conf 3)
- [ ] P2: Add optional output schema versioning metadata in JSON/JSONL exports for stable downstream imports. (Impact 3, Effort 2, Fit 3, Diff 1, Risk 1, Conf 3)
- [ ] P3: Refactor `web/app.js` into focused modules (state, API client, exporters, UI bindings) to reduce maintenance risk. (Impact 4, Effort 4, Fit 5, Diff 0, Risk 2, Conf 3)
- [ ] P3: Add Studio keyboard shortcuts for generate/export actions to speed high-volume review loops. (Impact 3, Effort 2, Fit 3, Diff 1, Risk 1, Conf 4)
- [ ] P3: Add release checklist automation script (version bump + changelog guard + build artifact verification). (Impact 2, Effort 3, Fit 3, Diff 0, Risk 2, Conf 3)
- [ ] P3: Document deep command recipes under `docs/` and keep README constrained to quickstart + links (1-2 screens). (Impact 2, Effort 2, Fit 4, Diff 0, Risk 1, Conf 5)
- [ ] P3: Add persona-card search/filter in Studio for large persona packs (50+). (Impact 3, Effort 2, Fit 3, Diff 1, Risk 1, Conf 4)
- [ ] P3: Add optional per-persona maxChars override for agent-feed generation workflows. (Impact 3, Effort 3, Fit 3, Diff 1, Risk 2, Conf 3)
- [ ] P3: Add benchmark script for feed parse + generation throughput on 1k-item payloads. (Impact 2, Effort 3, Fit 3, Diff 1, Risk 1, Conf 3)
- [ ] P3: Add feed-set migration helper when storage schema changes (with versioned upgrade path). (Impact 2, Effort 2, Fit 3, Diff 0, Risk 1, Conf 3)
- [ ] P3: Add copy-ready "trimmed chars" analytics summary after post edits for QA review. (Impact 2, Effort 2, Fit 3, Diff 1, Risk 1, Conf 3)
- [ ] P3: Add Studio import support for newline-delimited feed URL files to mirror CLI `--urls-file` workflows. (Impact 2, Effort 2, Fit 3, Diff 0, Risk 1, Conf 4)
- [ ] P3: Add Step 4 persona-name search/filter to control large timeline views. (Impact 2, Effort 2, Fit 3, Diff 1, Risk 1, Conf 3)
- [ ] P3: Add per-feed error detail accordion in Step 1 fetch status for faster debugging. (Impact 3, Effort 3, Fit 4, Diff 0, Risk 2, Conf 3)

## Implemented
- [x] 2026-02-13 P1: Extended browser E2E smoke to cover Step 4 agent feed (`build -> copy -> download`) in the existing Playwright flow. Evidence: `scripts/e2e-web.ts`; verification: `npm run lint`, `npm run typecheck`, `npm run build`, `npm run e2e:web` (blocked in this sandbox by `listen EPERM`), `node dist/cli.js generate --input /tmp/feed-jarvis-smoke-items-cycle2.json --persona Analyst --format jsonl --max-chars 180`.
- [x] 2026-02-13 P2: Added deterministic Step 4 assertion depth for rendered feed cards, copy status, and downloaded JSON payload structure (`meta` + `feed`). Evidence: `scripts/e2e-web.ts`; verification: `npm run lint`, `npm run typecheck`, `npm run build`, `npm test` (sandbox `listen EPERM` / cache-path `EPERM`), `npx vitest run test/concurrency.test.ts test/studioPrefs.test.ts test/feedSets.test.ts`.
- [x] 2026-02-13 P1: Added bounded configurable fetch concurrency across CLI + Studio/API (`--fetch-concurrency`, `FEED_JARVIS_FETCH_CONCURRENCY`, `fetchConcurrency` request field) using shared worker-limited execution. Evidence: `src/lib/concurrency.ts`, `src/cli.ts`, `src/server.ts`, `web/app.js`, `web/index.html`, `web/studioPrefs.js`; verification: `npm run lint`, `npm run typecheck`, `npm run build`, `npx vitest run test/concurrency.test.ts test/studioPrefs.test.ts`.
- [x] 2026-02-13 P1: Added concurrency behavior tests for CLI and server fetch flows with max in-flight assertions. Evidence: `test/cli.test.ts`, `test/server.test.ts`, `test/concurrency.test.ts`; verification: `npx vitest run test/concurrency.test.ts test/studioPrefs.test.ts` (full network/listen integration tests blocked in this sandbox by `listen EPERM`).
- [x] 2026-02-12 P1: Added browser-level Studio E2E smoke for critical flow (`fetch -> generate -> export`) with deterministic feed fixtures. Evidence: `scripts/e2e-web.ts`, `package.json`, `.github/workflows/ci.yml`; verification: `npm run lint`, `npm run typecheck`, `npm run build`, `npm run e2e:web` (environment blocked in this sandbox: `listen EPERM`), `npx playwright install chromium`.
- [x] 2026-02-12 P2: Added browser-driven export smoke assertions for `.txt`, `.jsonl`, `.csv` payloads and wired them into CI. Evidence: `scripts/e2e-web.ts`, `.github/workflows/ci.yml`, `CHANGELOG.md`, `README.md`; verification: `npm run lint`, `npm run typecheck`, `npm run build`, `npm run e2e:web` (environment blocked in this sandbox: `listen EPERM`).
- [x] 2026-02-12 P1: Studio feed-set OPML import/export (local-only) with dedupe-safe parsing and collision-safe naming during import. Evidence: `web/feedSets.js`, `web/feedSets.d.ts`, `web/app.js`, `web/index.html`, `test/feedSets.test.ts`; verification: `npx vitest run test/feedSets.test.ts`, `npm run lint`, `npm run typecheck`, `npm run build`.
- [x] 2026-02-12 P1: Studio live over-limit draft editing guidance (`current/max` + warning + one-click trim). Evidence: `web/postEditing.js`, `web/postEditing.d.ts`, `web/app.js`, `web/styles.css`, `test/postEditing.test.ts`; verification: `npx vitest run test/postEditing.test.ts`, `npm run lint`, `npm run typecheck`, `npm run build`, `node dist/cli.js generate --input /tmp/feed-jarvis-smoke-items.json --persona Analyst --format jsonl --max-chars 160`.
- [x] 2026-02-12 P1: Feed fetcher bounded retry/backoff for transient failures (network/timeouts + HTTP 408/429/5xx), honoring existing timeout and stale-cache fallback behavior. Evidence: `src/lib/feedFetch.ts`, `test/feedFetch.test.ts`; verification: `FEED_JARVIS_CACHE_DIR=/tmp/feed-jarvis-cache-test npx vitest run test/feedFetch.test.ts`, `npm run lint`, `npm run typecheck`, `npm run build`.
- [x] 2026-02-12 P1: CLI `fetch --urls-file <path>` support for newline-delimited URL ingestion with preserved allowlist + dedupe flow. Evidence: `src/cli.ts`, `test/cli.test.ts`, `README.md`, `CHANGELOG.md`; verification: `node dist/cli.js fetch --urls-file /tmp/feed-jarvis-urls.txt --allow-host example.org --no-cache --timeout-ms 1000` (expected network-restricted failure in sandbox after parsing file input), `npm run lint`, `npm run typecheck`, `npm run build`.
- [x] 2026-02-12 P1: Studio pasted JSON URL validation (`http/https` only) plus server-side generation guardrails for non-http(s) URLs. Evidence: `web/app.js`, `web/index.html`, `src/server.ts`, `test/server.test.ts`, `README.md`, `CHANGELOG.md`; verification: `npm run lint`, `npm run typecheck`, `npm run build`.
- [x] 2026-02-11 P1: Studio: add local-only rule presets (save/load/delete) for optional text rules (`prepend`/`append`/`hashtags`/UTM). Evidence: `web/index.html`, `web/app.js`, `web/styles.css`, `web/rulePresets.js`, `test/rulePresets.test.ts`; verification: `make check`, `npm run smoke:web`.
- [x] 2026-02-11 P2: CLI: add `fetch --opml <path>` support for local OPML feed URL ingestion with existing host allowlist enforcement. Evidence: `src/cli.ts`, `src/lib/opml.ts`, `test/opml.test.ts`, `test/cli.test.ts`; verification: `make check`, local smoke command (CLI OPML fetch via local HTTP server).
- [x] 2026-02-10 P2: CLI: `generate --stats` prints post counts + character-length distribution to stderr. Evidence: `src/cli.ts`, `test/cli.test.ts`; verification: `make check`.
- [x] 2026-02-10 P1: Studio: save/load named feed sets (local-only presets) to speed up repeat workflows. Evidence: `web/index.html`, `web/app.js`, `web/styles.css`, `web/feedSets.js`, `test/feedSets.test.ts`; verification: `make check`, `npm run smoke:web`.
- [x] 2026-02-10 P1: Studio: add "Download items.json" (and copy-to-clipboard) export for the filtered item set to bridge Studio to CLI workflows. Evidence: `web/index.html`, `web/app.js`, `web/styles.css`; verification: `make check`.
- [x] 2026-02-10 P1: Studio: optional generation text rules (prepend/append/hashtags) + basic UTM tagging, persisted locally and applied while always honoring `maxChars`. Evidence: `web/index.html`, `web/app.js`, `web/styles.css`, `src/lib/posts.ts`, `src/server.ts`, `test/posts.test.ts`, `test/server.test.ts`; verification: `make check`, `npm run smoke:web`.
- [x] 2026-02-10 P1: CLI: `generate --format csv` with metadata columns (persona/channel/template/title/url/post) plus `--channel`/`--template` and rule/UTM parity. Evidence: `src/cli.ts`, `src/lib/posts.ts`, `test/cli.test.ts`; verification: `make check` (includes CLI stdin test), manual: `tsx src/cli.ts generate --format csv ...`.
- [x] 2026-02-09 P1: Studio: remember per-channel `maxChars` (local-only) so switching channels restores the last-used value per channel. Evidence: `web/app.js`, `web/studioPrefs.js`, `test/studioPrefs.test.ts`; verification: `make check`, `npm run smoke:web`.
- [x] 2026-02-09 P1: Studio: show richer fetch summary after loading items (feeds, cache vs network, deduped, trimmed-to-max). Evidence: `web/app.js`, `src/server.ts`, `test/server.test.ts`; verification: `make check`, `npm run smoke:web`.
- [x] 2026-02-09 P2: Studio server: return a clearer `/api/fetch` summary (separate `deduped` vs `limited`) + add test coverage. Evidence: `src/server.ts`, `test/server.test.ts`; verification: `make check`.
- [x] 2026-02-09 P0: CI: bump CodeQL Action to `v4` to remove deprecation warning and keep analysis future-proof. Evidence: `.github/workflows/codeql.yml`; verification: `gh run watch 21830511384 --exit-status`.
- [x] 2026-02-09 P1: Studio: import/export personas (JSON) from the UI (local-only), persisted in `localStorage`, and applied during generation. Evidence: `web/index.html`, `web/app.js`, `test/server.test.ts`; verification: `make check`, `npm run smoke:web`.
- [x] 2026-02-09 P1: Studio: enrich exports (CSV + JSONL) with source metadata (title/url) plus persona/channel/template; snapshot generation inputs for aligned export; show source title/link above drafts. Evidence: `web/index.html`, `web/app.js`, `web/styles.css`, `README.md`, `CHANGELOG.md`; verification: `make check`, `npm run smoke:web`.
- [x] 2026-02-09 P1: Studio: added basic item filters (include/exclude keywords + minimum title length) and applied them before generation/export; persisted in `localStorage`; added unit coverage for the filter logic. Evidence: `web/index.html`, `web/app.js`, `web/filters.js`, `test/filters.test.ts`; verification: `make check`, `npm run smoke:web`.
- [x] 2026-02-09 P1: Studio UI: hardened API error handling for unknown thrown values and non-JSON responses so statuses remain actionable. Evidence: `web/app.js`; verification: `make check`, `npm run smoke:web`.
- [x] 2026-02-09 P2: Studio UI: fixed header "GitHub" links to point at this repository. Evidence: `web/index.html`, `web/about.html`; verification: `npm run lint`.
- [x] 2026-02-09 P0: Fixed failing "Dependabot Updates" GitHub Actions runs by granting required default `GITHUB_TOKEN` workflow permissions at the repo level and pinning `ci.yml` to least-privilege permissions. Evidence: `.github/workflows/ci.yml`, repo Actions workflow setting; verification: `gh api /repos/sarveshkapre/feed-jarvis/actions/permissions/workflow`.
- [x] 2026-02-09 P0: Added `npm run smoke:web` to CI to catch Studio regressions beyond unit/integration tests. Evidence: `.github/workflows/ci.yml`; verification: `npm run smoke:web`.
- [x] 2026-02-09 P1: Extended private-network fetch protection with DNS resolution checks (blocks hostnames resolving to private/local IP ranges). Evidence: `src/lib/feedFetch.ts`, `test/feedFetch.test.ts`; verification: `make check`.
- [x] 2026-02-08 P0: Restored CI green by fixing Biome lint/format violations. Evidence: `src/server.ts`, `web/app.js`, `web/styles.css`; verification: `make check`.
- [x] 2026-02-08 P0: Added server integration tests for key Studio APIs. Evidence: `test/server.test.ts`; verification: `npm test` (includes 5 server tests).
- [x] 2026-02-08 P1: Hardened Studio feed ingestion by blocking localhost/private-network hosts by default with explicit override. Evidence: `src/lib/feedFetch.ts`, `src/server.ts`; verification: `test/feedFetch.test.ts`, `test/server.test.ts`.
- [x] 2026-02-08 P1: Removed `innerHTML` persona rendering path to reduce DOM injection risk. Evidence: `web/app.js`.
- [x] 2026-02-08 P1: Added Studio session persistence via `localStorage` for source mode and form settings. Evidence: `web/app.js`.
- [x] 2026-02-08 P1: Fixed source-mode toggle scoping so channel buttons no longer affect feed/json panel visibility. Evidence: `web/app.js`.
- [x] 2026-02-08 P2: Added repeatable Studio smoke check command. Evidence: `scripts/smoke-web.ts`, `package.json`, `PROJECT.md`; verification: `npm run smoke:web`.
- [x] 2026-02-08 P2: Synced docs with shipped behavior changes. Evidence: `README.md`, `CHANGELOG.md`, `UPDATE.md`.

## Insights
- Step 4 UI actions (`build -> copy -> download`) now have deterministic browser assertions, reducing regression blind spots between timeline rendering and export/copy wiring.
- Bounded concurrency materially reduces peak in-flight requests on large URL batches while preserving output ordering and dedupe behavior.
- Browser-level coverage is now practical and deterministic by stubbing feed fetches in a local test server and driving real DOM interactions via Playwright.
- Export verification should stay browser-driven because it catches regressions in both payload construction and download wiring.
- OPML import/export is now parity-complete in Studio for local feed-set interoperability and migration.
- Live over-limit feedback in draft editing materially reduces manual QA friction for channel-specific `maxChars` constraints.
- Bounded retries should only apply to transient classes (network/timeouts + 408/429/5xx); 4xx validation errors should fail fast with no retry.
- URL-file ingestion provides high-value interoperability with near-zero UX overhead and keeps the same allowlist/safety posture as direct URL inputs.
- Studio JSON ingestion quality improved by validating URL schemes client-side and server-side, preventing malformed links from reaching exports.
- Local `make check` output matched historical failing GitHub Actions runs exactly, so Biome drift was the root CI failure.
- Studio fetch security needed a stricter default than CLI: server-side requests can be triggered from browser clients, so private-host blocking now defaults to on for Studio.
- Disk cache can affect integration tests if URLs are reused; tests should prefer unique URLs or isolated cache settings.
- Gap map (cycle1 update): Missing = browser E2E for Step 4 agent feed path; Weak = browser assertion depth beyond critical Step 3 flow; Parity = local-first feed grouping with OPML import/export, filters/rules, metadata exports, and Step 3 E2E; Differentiator = deterministic local-first workflow with strong private-host safeguards.
- Market scan (untrusted web, cycle1): baseline feed-to-social UX consistently includes reusable content rules and lightweight feed automation/import paths; OPML support and reusable text rules are common interoperability/efficiency expectations.
- Market scan (untrusted web): RSS-to-social tools emphasize (1) rules/filters (keywords, duplicates), (2) configurable post text (prepend/append, tags/UTMs), (3) queues/scheduling with optional review, and (4) downstream automation/export to schedulers.
- Market scan (untrusted web, cycle4): auto-publish tools highlight scheduler queue integration and feed-to-channel mapping, with copy review as a differentiator for teams.
- Market scan (untrusted web, cycle5): auto-publish workflows commonly support per-feed post text customization (including hashtags) and basic tracking via UTM parameters, plus downstream scheduling/approval flows; our Studio now covers the text customization + UTM parity while staying local-first.
- Market scan (untrusted web, cycle1): RSS-to-social automation tools emphasize (1) reusable feed groupings, (2) fast filtering/muting to control noise, (3) schedulers/queues, and (4) export/automation bridges (CSV/Zapier/Buffer) plus basic tracking (UTM). This session focuses on local-first feed set presets + a clean "items.json" bridge to the CLI.
- References (untrusted web):
  - https://www.inoreader.com/blog/2026/01/save-time-with-automations.html
  - https://feedly.com/new-features/posts/feedly-ai-and-summarization
  - https://feedly.helpscoutdocs.com/article/345-mute-filters
  - https://zapier.com/apps/buffer/integrations/rss
  - https://support.buffer.com/article/613-automating-rss-feeds-using-feedly-and-zapier
  - https://help.metricool.com/en/article/how-to-automate-posts-with-an-rss-feed-1m6ahtz/
  - https://dlvrit.com/
  - https://www.make.com/en/integrations/rss
  - https://rss.app/blog/how-to-filter-rss-feeds
  - https://help.hootsuite.com/hc/en-us/articles/204598580-Auto-publish-posts-from-RSS-feeds
  - https://help.missinglettr.com/article/392-how-do-i-change-my-default-utm-settings
  - https://help.missinglettr.com/article/386-how-do-i-add-hashtags-to-my-default-post-content-settings
  - https://support.sproutsocial.com/hc/en-us/articles/20299161205645-How-do-I-use-Automated-Feed-Publishing-on-the-Professional-and-Advanced-Plans
  - https://missinglettr.com/features/drip-campaigns/
  - https://zapier.com/blog/rss-to-buffer/
  - https://help.buffer.com/en/articles/3056329-how-to-automate-your-posts-from-rss-feeds

## Notes
- This file is maintained by the autonomous clone loop.
